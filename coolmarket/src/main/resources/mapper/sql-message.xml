<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="coolmarket.mapper.MessageMapper">

	<insert id="insertMessage" parameterType="coolmarket.dto.MessageDto">

		<![CDATA[ 
			INSERT INTO
				msg (buyer_no, buyer_name, contents)
			VALUES
				(#{buyerNo}, #{buyerName}, #{contents})
		]]>
	</insert>
	
	<select id="checkRoom" resultType="coolmarket.dto.ChatRoomDto" parameterType="coolmarket.dto.ChatRoomDto">
		
		<![CDATA[
			SELECT 
				room_no, mar_no, seller_no, buyer_no
			FROM 
				chat_room
			WHERE 
				seller_no = #{sellerNo} 
			AND buyer_no = #{buyerNo}
			AND mar_no = #{marNo}
		]]>

	</select>
	
	
	<insert id="createRoom" useGeneratedKeys="true" keyProperty="roomNo" parameterType="coolmarket.dto.ChatRoomDto">
		
		<![CDATA[ 
			INSERT INTO 
				chat_room 
				(mar_no, seller_no, buyer_no)
			VALUES 
				(#{marNo}, #{sellerNo}, #{buyerNo})
		]]>
			
	</insert>
	
	<select id="checkRoom1" resultType="coolmarket.dto.ChatRoomDto" parameterType="int">
		
		<![CDATA[
			SELECT 
				room_no, mar_no, seller_no, buyer_no
			FROM 
				chat_room
			WHERE 
				room_no = #{chatRoomNo}
		]]>

	</select>
	
</mapper>